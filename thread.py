
import csv
from google_images_download import google_images_download
response = google_images_download.googleimagesdownload() 
import os
import shutil
import shutil
import logging
import threading

logging.basicConfig(level=logging.DEBUG,
                    format='[%(levelname)s] (%(threadName)-10s) %(message)s',
                    )


def scrap_Google(sup,inf,pro):
    res = []
    mydict = []
    with open('celeb.csv', mode='r') as infile:
        reader = csv.reader(infile)
        mydict = {int(rows[0]):rows[1] for rows in reader}

    i=0
    errors = []

    for key in mydict.items():
        id2 = key[0]
        name = key[1]
        if (id2 >= sup) and (id2 < inf):
            logging.debug('ID: ' + str(key[0]))
            keyword = name +  " musician"
            arguments = {"keywords": keyword,"limit":1,"print_urls":False,"aspect_ratio":"square","proxy":pro}  
            try: 
                a,b = response.download(arguments)
                lis = [v for k,v in a.items()]
                oldPath = lis[0][0]
                os.rename(oldPath, "/home/pc/Desktop/threading/result/"+str(id2)+".jpg") 
                st = oldPath
                st = st.split('/')
                folder = st[len(st)-2]
                #shutil.rmtree('/home/pc/Desktop/work2/downloads/' + folder)
                continue
            except:
                logging.debug('ERROR ID: ' + str(id2))
                errors.append(id2)
                continue

    f = open("erros.txt", "a")
    g = open("finish.txt", "a")
    f.write(errors)
    g.write("thread: " + str(sup) + "-" + str(inf) + "finished")
    f.close()
    g.close()
    logging.debug('FINISHED THREAD SCRAPPING')


# t1 = threading.Thread(name='t1', target=scrap_Google,args=(0,3000,pr[0]))
# t2 = threading.Thread(name='t2', target=scrap_Google,args=(3000,6000,pr[1]))
# t3 = threading.Thread(name='t3', target=scrap_Google,args=(6000,9000,pr[2]))
# t4 = threading.Thread(name='t4', target=scrap_Google,args=(9000,12000,pr[3]))
# t5 = threading.Thread(name='t5', target=scrap_Google,args=(12000,15000,pr[4]))
# t6 = threading.Thread(name='t6', target=scrap_Google,args=(15000,18000,pr[5]))
# t7 = threading.Thread(name='t7', target=scrap_Google,args=(18000,21000,pr[6]))
# #t8 = threading.Thread(name='t8', target=scrap_Google,args=(21000,24000,'167.71.182.13:3128'))
# #t9 = threading.Thread(name='t9', target=scrap_Google,args=(24000,27000,'50.233.228.147:8080'))
# #t10 = threading.Thread(name='t10', target=scrap_Google,args=(27000,30000,'75.73.50.82:80'))

# t1.start()
# t2.start()
# t3.start()
# t4.start()
# t5.start()
# t6.start()
# t7.start()
# #t8.start()
# #t9.start()
# #t10.start()


pro = ['151.80.199.89:3128','136.243.47.220:3128','109.86.229.189:8080','138.201.72.117:80','138.201.223.250:31288','138.68.165.154:3128','138.68.165.154:8080','138.68.161.14:8080','207.154.200.199:3128','185.25.48.215:55960','185.234.37.207:80','188.166.83.13:3128','185.199.84.161:53281','185.181.18.103:8080','188.226.141.127:3128','194.167.44.91:80','188.226.141.211:3128','188.166.119.186:80','188.166.83.34:3128','185.242.180.81:3128','192.81.223.236:3128','188.166.83.20:8080','188.225.9.121:8080','185.80.130.73:80','188.166.83.13:8080','193.160.214.143:8090','188.166.83.34:8080','195.238.85.215:50948','188.166.83.17:3128','195.191.250.38:3128','31.193.124.70:53281','207.154.231.217:3128','195.175.209.194:8080','163.172.152.52:8811','138.68.173.29:3128','138.68.173.29:8080','164.68.121.190:8080','138.68.161.14:3128','178.32.80.239:8080','163.172.169.167:3129','159.65.95.233:8080','51.158.120.84:8811','207.154.231.216:3128','217.65.5.113:3128','194.226.34.132:5555','207.154.231.213:8080','34.90.113.143:3128','193.200.151.69:32086','207.154.231.213:3128','163.172.189.32:8811','163.172.136.226:8811','163.172.169.167:3128','176.9.75.42:8080','176.62.182.29:58350','167.172.224.108:3128','176.9.75.42:3128','51.158.68.133:8811','213.183.51.172:3128','34.65.47.49:8080','195.123.212.199:39178','207.154.231.216:8080','37.52.11.12:42180','195.154.67.61:3128','176.120.37.67:53682','163.172.147.94:8811','173.212.196.163:8000','178.62.232.215:8080','207.154.231.217:8080','173.212.202.65:80','62.33.207.201:80','45.137.150.161:8080','46.4.96.137:3128','207.154.231.211:3128','207.180.223.239:80','176.9.119.170:8080','176.193.255.162:8080','178.62.193.19:3128','207.154.231.211:8080','46.119.215.98:8080','176.112.106.230:33996','51.158.123.35:8811','62.33.207.202:3128','51.158.79.163:3128','52.157.177.98:80','212.47.234.231:80','176.53.2.122:8080','178.62.193.19:8080','212.109.199.140:8888','41.65.181.134:8080','46.45.129.16:80','178.62.236.132:8080','51.158.68.68:8811','88.198.24.108:8080','62.33.207.202:80','78.47.176.200:8080','51.158.98.121:8811','176.9.119.170:3128','51.158.111.242:8811','46.4.96.137:8080','51.158.106.54:8811','82.196.11.105:3128','88.198.50.103:8080','54.36.89.115:3128','91.205.174.26:80','80.32.122.118:55655','62.33.207.196:3128','51.158.108.135:8811','80.241.222.137:80','62.33.207.196:80','95.158.1.26:56234','89.140.125.17:80','79.172.214.11:80','51.158.111.229:8811','62.33.207.201:3128','85.26.146.169:80','91.77.162.117:8080','95.85.36.236:3128','82.196.11.105:8080','51.158.68.26:8811','92.247.148.126:8080','86.100.72.118:31121','95.85.36.236:8080','51.158.99.51:8811','88.198.24.108:3128','93.190.253.50:80','77.73.241.154:80','94.130.92.52:3128','80.241.222.138:80','84.52.76.91:41258','87.249.22.114:8080','88.198.50.103:3128','90.176.236.40:80']

pro2 = ['103.194.242.254:60025','101.108.112.124:8080','1.10.245.11:8080','103.129.194.1:30335','103.127.171.52:3128','103.250.166.6:35101','103.138.226.35:3128','103.240.206.152:55740','1.0.183.113:8080','101.108.111.213:8080','103.31.45.174:8080','103.60.172.67:80','104.244.75.26:8080','103.51.15.244:3128','103.52.188.144:80','104.248.53.46:3128','104.248.8.101:8080','104.250.34.179:80','103.83.79.69:80','105.19.49.179:80','109.68.41.78:8080','109.239.255.33:8888','110.243.25.218:9999','113.53.230.167:80','111.29.3.194:8080','111.29.3.222:80','111.29.3.221:80','111.29.3.190:8080','111.29.3.195:8080','111.29.3.189:80','111.29.3.192:8080','111.29.3.223:80','111.29.3.224:8080','110.44.122.198:8080','111.29.3.194:80','110.77.171.232:8080','111.29.3.184:80','113.172.223.205:8080','110.77.181.219:62225','111.29.3.186:8080','111.29.3.191:80','110.78.152.40:8080','114.106.134.188:61234','111.29.3.192:80','111.29.3.191:8080','111.29.3.185:80','111.29.3.193:8080','115.110.129.134:80','111.29.3.193:80','111.29.3.195:80','115.31.142.169:35938','111.29.3.185:8080','115.160.21.243:8080','117.102.9.12:3128','116.114.19.204:443','115.239.66.30:61234','117.206.148.216:8080','118.137.175.68:8080','117.211.100.22:3128','116.71.132.53:8080','118.172.201.60:57356','118.172.201.34:36670','118.174.220.130:41419','119.42.70.146:8080','120.210.219.73:8080','118.70.144.77:3128','118.27.31.50:3128','120.203.18.54:9999','124.122.184.156:8118','120.92.178.3:8111','121.123.29.150:8080','136.243.47.220:3128','125.88.190.1:3128','122.50.5.148:10000','128.199.36.25:8080','124.158.177.171:23500','124.40.248.202:8080','138.197.157.44:3128','138.197.157.32:3128','138.197.145.103:8080','138.197.157.44:8080','138.197.157.60:3128','125.27.251.87:58182','138.197.157.60:8080','138.197.157.45:3128','138.197.145.103:3128','138.197.157.32:8080','138.197.136.78:8080','138.197.136.78:80','167.99.85.83:8080','167.71.254.71:3128','167.71.138.113:8080','167.71.94.127:3128','181.176.187.133:80','185.144.157.135:80','185.144.156.40:8080','185.144.156.40:80','185.144.157.135:8080','183.91.33.41:86','183.91.33.41:87','183.91.33.41:90','183.91.33.41:91','183.91.33.41:85','183.91.33.41:83','183.91.33.41:88','183.91.33.41:89','183.91.33.41:84','183.91.33.41:8091','183.91.33.41:81','183.91.33.41:8090','183.91.33.41:8087','183.91.33.41:8086','185.237.98.57:80','185.237.99.101:80','185.242.180.81:3128','185.237.98.35:80','185.120.36.150:8080','185.204.0.16:3128','185.151.151.190:3128','185.20.115.114:57236','185.237.80.214:47693','186.148.189.27:8080','186.227.178.13:8080','188.166.83.20:8080','188.166.83.20:3128','188.166.119.186:80','188.166.83.13:8080','188.166.83.34:3128','188.166.83.34:8080','188.166.83.13:3128','188.166.83.17:8080','188.166.83.17:3128','188.225.9.121:8080','187.16.4.121:8080','188.226.141.211:3128','188.226.141.61:8080','188.226.141.61:3128','187.109.210.213:8080','188.226.141.211:8080','188.252.64.154:60446','188.133.137.9:8081','188.226.141.127:3128','188.226.141.127:8080','190.107.233.36:3128','188.0.163.90:30121','187.190.220.19:999','190.104.255.6:8080','190.7.113.51:80','190.7.113.53:80','190.7.113.57:80','187.44.226.142:8085','200.89.178.36:80','200.199.114.226:33932','200.89.178.64:3128','200.89.178.64:8080','200.89.178.64:80','200.89.178.36:8080','200.89.174.181:3128','200.89.174.109:80','200.89.174.109:8080','200.89.178.36:3128','200.89.159.149:8000','201.219.9.66:999','23.237.173.102:3128','31.145.138.129:31871','34.73.123.161:8080','222.124.193.113:8080','34.213.184.205:3128','35.235.75.244:3128','34.90.113.143:3128','34.65.47.49:8080','31.193.124.70:53281','36.104.132.178:3128','34.68.165.19:80','36.25.243.251:80','36.66.172.121:39810','36.89.28.250:8080','36.91.30.81:8080','41.180.64.254:80','36.91.58.89:8080','36.90.47.91:8888','36.90.208.50:58912','41.217.219.53:41935','41.73.15.130:80','41.73.15.134:80','41.73.15.246:80','36.92.67.237:8080','41.73.15.134:8080','41.73.15.130:8080','41.73.15.246:8080','39.137.107.98:80','39.137.69.10:80','39.137.107.98:8080','41.254.42.2:9999','41.190.147.158:55258','41.59.254.102:80','42.201.228.29:8080','41.169.158.90:8080','41.66.76.94:8080','41.79.66.106:58369','43.255.228.150:3128','42.159.91.248:8080','45.76.138.224:3128','45.55.23.78:3128','45.55.23.78:8080','45.123.43.66:59627','45.236.129.109:80','45.55.9.218:3128','45.55.9.218:8080','45.55.27.15:3128','45.55.27.161:8080','45.55.27.15:8080','45.55.27.161:3128','46.235.53.26:3128','46.119.215.98:8080','45.236.129.109:3128','45.79.50.63:8118','46.4.96.137:8080','46.4.96.137:3128','45.71.113.203:999','45.228.234.190:999','46.16.228.6:8080','46.24.85.74:34842','46.36.64.194:8080','47.52.32.109:80','5.189.133.231:80','46.243.12.157:80','47.52.225.33:80','46.105.123.30:3128','46.32.68.188:39707','51.15.97.189:3128','5.56.103.45:56466','51.158.106.54:8811','51.15.166.107:3128','51.158.108.135:8811','50.235.28.146:3128','51.158.111.229:8811','51.158.111.242:8811','51.158.123.35:8811','51.158.119.88:8811','51.158.68.26:8811','51.158.98.121:8811','52.157.177.98:80','51.158.120.84:8811','51.158.179.242:8080','51.158.68.68:8811','51.158.99.51:8811','51.158.68.133:8811','49.49.78.246:8080','54.39.96.159:8080','51.15.168.43:80','51.68.141.240:3128','51.158.171.208:8080','51.15.120.43:3128','5.77.254.157:8080','51.158.79.163:3128','67.205.146.29:3128','67.205.132.241:3128','67.205.149.230:3128','67.205.174.209:8080','60.248.199.206:80','67.205.146.29:8080','67.205.132.241:8080','67.205.149.230:8080','67.205.174.209:3128','60.167.75.8:8118','78.47.176.200:8080','51.75.153.238:3128','60.187.53.182:61234','61.7.138.4:8080','62.159.156.142:80']
profinal = ['163.172.152.52:8811','136.243.47.220:3128','104.248.53.46:3128','104.248.86.193:8080','138.68.161.14:3128','138.68.165.154:3128','104.248.8.101:8080','138.68.161.14:8080','188.226.141.211:8080','185.25.48.215:55960','185.234.37.207:80','188.166.83.13:3128','188.166.83.34:3128','188.166.119.186:80','188.226.141.127:3128','185.110.136.23:31532','188.226.141.61:8080','188.226.141.211:3128','188.166.83.20:8080','188.225.9.121:8080','207.154.231.211:3128','185.242.180.81:3128','188.166.83.17:3128','188.226.141.61:3128','188.166.83.34:8080','188.226.141.127:8080','217.182.75.229:8888','188.166.83.13:8080','188.166.83.17:8080','206.189.229.46:3128','198.199.120.102:3128','188.166.83.20:3128','207.154.231.216:3128','163.172.189.32:8811','138.68.173.29:3128','138.68.173.29:8080','157.245.86.42:3128','159.203.166.41:3128','165.227.215.71:8080','109.73.179.175:23500','139.59.169.246:3128','5.9.143.59:3128','45.137.150.161:8080','207.154.231.217:3128','51.158.98.121:8811','206.189.177.191:8080','34.90.113.143:3128','192.81.223.236:3128','194.167.44.91:80','167.172.224.108:80','149.255.154.62:8080','163.172.169.167:3128','159.203.166.41:8080','165.227.215.62:3128','173.249.35.163:10010','116.203.47.157:8080','139.59.169.246:8080','51.158.120.84:8811','46.235.53.26:3128','34.65.47.49:8080','54.36.89.115:3128','207.154.231.213:8080','62.173.145.48:3128','193.200.151.69:32086','198.199.120.102:8080','167.71.132.188:8080','159.203.91.6:3128','163.172.219.130:443','162.243.64.151:3128','173.249.35.163:10020','138.68.165.154:8080','159.65.95.233:8080','51.158.68.133:8811','51.158.119.88:8811','46.4.96.137:3128','62.33.207.196:80','207.154.231.216:8080','82.196.11.105:3128','195.154.67.61:3128','176.123.61.238:3128','159.203.91.6:8080','165.227.215.71:3128','164.68.121.190:8080','207.154.231.213:3128','163.172.169.167:3129','176.9.75.42:3128','62.33.207.201:80','62.33.207.202:80','52.157.177.98:80','62.33.207.201:3128','207.180.223.239:80','176.9.119.170:8080','163.172.136.226:8811','178.62.193.19:3128','165.227.220.35:3128','207.154.231.217:8080','206.189.192.5:8080','62.33.207.202:3128','67.205.174.209:3128','67.205.132.241:3128','163.172.147.94:8811','178.62.193.19:8080','176.9.75.42:8080','212.42.206.58:3128','207.154.231.211:8080','67.205.132.241:8080','88.198.24.108:8080','67.205.146.29:3128','167.172.140.184:3128','46.105.123.30:3128','46.4.96.137:8080','80.241.222.137:80','67.205.146.29:8080','176.9.119.170:3128','88.198.50.103:8080','67.205.149.230:8080','46.119.215.98:8080','62.33.207.196:3128','85.26.146.169:80','78.47.176.200:8080','86.100.72.118:31121','51.158.106.54:8811','83.17.171.250:57087','92.222.180.156:8080','67.205.149.230:3128','88.198.24.108:3128','51.158.108.135:8811','87.244.176.213:54467','91.205.174.26:80','51.158.111.229:8811','93.190.253.50:80','51.158.68.26:8811','94.130.92.52:3128','51.158.99.51:8811','178.62.232.215:8080','173.212.202.65:80','51.158.111.242:8811','95.85.36.236:3128','77.73.241.154:80','173.249.35.163:1448','67.205.174.209:8080','95.85.36.236:8080','80.241.222.138:80','87.249.22.114:8080','88.198.50.103:3128','88.2.19.108:8080','92.222.180.156:3128','88.247.165.215:51331','89.140.125.17:80']

profinal.reverse()
for i in range(100):
    inf = 300*i
    sup = inf+300  
    t = threading.Thread(name='t'+str(i),target=scrap_Google, args=(inf,sup,profinal[i]))
    t.start()